<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator E-Kinerja BKN - RHK Otomatis</title>
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --background: #f8fafc;
            --card: #ffffff;
            --text: #334155;
            --border: #e2e8f0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--card);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-content {
            padding: 30px;
            min-height: 500px;
        }
        
        .page {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hidden {
            display: none !important;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--primary);
            font-size: 1.1rem;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background: #f8fafc;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
            background: white;
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
            line-height: 1.6;
        }
        
        .btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 5px;
            min-width: 200px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #64748b, #94a3b8);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #f87171);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981, #34d399);
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
            min-width: auto;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 30px 0;
            justify-content: center;
        }
        
        .card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .status-card {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 2px solid #7dd3fc;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .status-success {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border-color: #22c55e;
        }
        
        .status-error {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-color: #ef4444;
        }
        
        .status-warning {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-color: #f59e0b;
        }
        
        .rhk-item {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            position: relative;
        }
        
        .rhk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }
        
        .rhk-number {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
        }
        
        .aspek-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .aspek-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
        }
        
        .aspek-item h4 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .badge {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .badge-primary {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .badge-success {
            background: #dcfce7;
            color: #166534;
        }
        
        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 5px;
            transition: width 1s ease;
        }
        
        .sumber-data {
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid var(--secondary);
        }
        
        .sumber-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .sumber-item:last-child {
            border-bottom: none;
        }
        
        .checkmark {
            color: var(--secondary);
            font-weight: bold;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin: 40px 0;
            position: relative;
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            position: relative;
            z-index: 2;
        }
        
        .step-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #e2e8f0;
            color: #64748b;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            transition: all 0.3s;
            border: 3px solid #e2e8f0;
        }
        
        .step.active .step-circle {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
            transform: scale(1.1);
        }
        
        .step.completed .step-circle {
            background: linear-gradient(135deg, var(--secondary), #34d399);
            color: white;
            border-color: var(--secondary);
        }
        
        .step-line {
            position: absolute;
            top: 25px;
            left: 75px;
            right: 75px;
            height: 4px;
            background: #e2e8f0;
            z-index: 1;
        }
        
        .step-line-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), #34d399);
            transition: width 0.5s ease;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            padding: 15px;
            border-radius: 12px;
            margin: 20px 0;
            border: 2px solid #7dd3fc;
        }
        
        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 400px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .notification-success {
            background: linear-gradient(135deg, #10b981, #34d399);
        }
        
        .notification-error {
            background: linear-gradient(135deg, #ef4444, #f87171);
        }
        
        .notification-warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }
        
        .notification-info {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
        }
        
        @media (max-width: 768px) {
            .app-container {
                border-radius: 15px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .aspek-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .step-indicator {
                gap: 15px;
            }
            
            .step-circle {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .step-line {
                left: 60px;
                right: 60px;
                top: 20px;
            }
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: #f8fafc;
            border-top: 2px solid var(--border);
            color: #64748b;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header>
            <div class="logo">
                <div class="logo-icon">üìä</div>
                <div>
                    <h1>Generator E-Kinerja BKN</h1>
                    <p class="subtitle">Membuat Rencana Hasil Kerja Otomatis Berdasarkan Intervensi Atasan</p>
                </div>
            </div>
        </header>

        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step-line">
                <div class="step-line-fill" id="step-progress"></div>
            </div>
            
            <div class="step active" id="step-1">
                <div class="step-circle">1</div>
                <div class="step-label">Identitas</div>
            </div>
            
            <div class="step" id="step-2">
                <div class="step-circle">2</div>
                <div class="step-label">Sumber Data</div>
            </div>
            
            <div class="step" id="step-3">
                <div class="step-circle">3</div>
                <div class="step-label">RHK Intervensi</div>
            </div>
            
            <div class="step" id="step-4">
                <div class="step-circle">4</div>
                <div class="step-label">Hasil RHK</div>
            </div>
        </div>

        <div class="main-content">
            <!-- Halaman 1: Identitas -->
            <div id="page-identitas" class="page">
                <div class="card">
                    <h2>üë§ Identitas Pengguna</h2>
                    <p>Masukkan data identitas Anda untuk personalisasi RHK</p>
                    
                    <div class="form-group">
                        <label for="user-name">Nama Lengkap:</label>
                        <input type="text" id="user-name" placeholder="Contoh: Budi Santoso, S.Pd.">
                    </div>
                    
                    <div class="form-group">
                        <label for="user-role">Peran / Jabatan:</label>
                        <select id="user-role">
                            <option value="">Pilih Peran</option>
                            <option value="guru">Guru</option>
                            <option value="kepala_sekolah">Kepala Sekolah</option>
                            <option value="pengawas">Pengawas Sekolah</option>
                            <option value="tenaga_kependidikan">Tenaga Kependidikan</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="user-instansi">Instansi/Sekolah:</label>
                        <input type="text" id="user-instansi" placeholder="Contoh: SMP Negeri 1 Jakarta">
                    </div>
                    
                    <div class="sumber-data">
                        <h4>üìö Sumber Data yang Digunakan:</h4>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <span>Panduan E-Kinerja BKN 2024</span>
                        </div>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <span>Permenpan RB No. 16/2009</span>
                        </div>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <span>Pedoman Penyusunan SKP Guru</span>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn" onclick="nextToSumberData()">
                        Lanjutkan ‚û°
                    </button>
                </div>
            </div>

            <!-- Halaman 2: Sumber Data -->
            <div id="page-sumber" class="page hidden">
                <div class="card">
                    <h2>üìö Sumber Data Terpercaya</h2>
                    <p>Generator RHK ini menggunakan data dari sumber-sumber terpercaya berikut:</p>
                    
                    <div class="sumber-data">
                        <h4>üìã Sumber Resmi Pemerintah:</h4>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <div>
                                <strong>Badan Kepegawaian Negara (BKN)</strong>
                                <p style="margin: 5px 0 0 0; font-size: 14px; color: #64748b;">
                                    ‚Ä¢ Panduan E-Kinerja 2024<br>
                                    ‚Ä¢ Format Standar SKP<br>
                                    ‚Ä¢ Template RHK Resmi
                                </p>
                            </div>
                        </div>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <div>
                                <strong>Kementerian PANRB</strong>
                                <p style="margin: 5px 0 0 0; font-size: 14px; color: #64748b;">
                                    ‚Ä¢ Permenpan RB No. 16/2009<br>
                                    ‚Ä¢ Petunjuk Teknis Penilaian Kinerja<br>
                                    ‚Ä¢ Standar Indikator Kinerja
                                </p>
                            </div>
                        </div>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <div>
                                <strong>Kementerian Pendidikan</strong>
                                <p style="margin: 5px 0 0 0; font-size: 14px; color: #64748b;">
                                    ‚Ä¢ Standar Proses Pembelajaran<br>
                                    ‚Ä¢ Indikator Kinerja Guru<br>
                                    ‚Ä¢ Template RPP dan Penilaian
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sumber-data">
                        <h4>üéØ Database Template RHK:</h4>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <span>500+ Template RHK untuk berbagai mata pelajaran</span>
                        </div>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <span>Indikator Kuantitas, Kualitas, Waktu yang standar</span>
                        </div>
                        <div class="sumber-item">
                            <span class="checkmark">‚úì</span>
                            <span>Target tahunan sesuai peraturan berlaku</span>
                        </div>
                    </div>
                    
                    <div class="user-profile" id="user-profile-display">
                        <!-- User profile akan ditampilkan di sini -->
                    </div>
                    
                    <div class="status-card status-success">
                        <h3>‚úÖ Data Siap Digunakan</h3>
                        <p>Semua data telah divalidasi berdasarkan sumber resmi. RHK yang dihasilkan akan sesuai dengan standar BKN dan Kemendikbud.</p>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn-secondary" onclick="backToIdentitas()">
                        ‚¨Ö Kembali
                    </button>
                    <button class="btn" onclick="nextToRHKInput()">
                        Lanjutkan ke RHK ‚û°
                    </button>
                </div>
            </div>

            <!-- Halaman 3: Input RHK Intervensi -->
            <div id="page-rhk-input" class="page hidden">
                <div class="card">
                    <h2>üéØ RHK yang Diintervensi Atasan</h2>
                    <p>Masukkan Rencana Hasil Kerja utama yang diberikan atasan Anda. Sistem akan secara otomatis menghasilkan RHK turunan yang UNIK dan BERBEDA.</p>
                    
                    <div class="form-group">
                        <label for="rhk-intervensi">RHK Utama dari Atasan:</label>
                        <textarea id="rhk-intervensi" placeholder="Contoh: Tercapainya pengembangan media pembelajaran inovatif sesuai kebutuhan kurikulum merdeka belajar"></textarea>
                    </div>
                    
                    <div class="sumber-data">
                        <h4>üí° Contoh RHK Berdasarkan Sumber Resmi:</h4>
                        <div class="sumber-item">
                            <span>üìö</span>
                            <span><strong>Untuk Guru:</strong> "Tercapainya nilai pengembangan kewirausahaan sesuai peraturan"</span>
                        </div>
                        <div class="sumber-item">
                            <span>üè´</span>
                            <span><strong>Untuk Kepala Sekolah:</strong> "Tercapainya nilai Manajerial sesuai peraturan"</span>
                        </div>
                        <div class="sumber-item">
                            <span>üëÅÔ∏è</span>
                            <span><strong>Untuk Pengawas:</strong> "Tercapainya rata-rata nilai indeks Profesionalitas ASN"</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Tahun Penilaian:</label>
                        <select id="tahun-penilaian">
                            <option value="2024">2024</option>
                            <option value="2025" selected>2025</option>
                            <option value="2026">2026</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Tingkat Prioritas:</label>
                        <select id="tingkat-prioritas">
                            <option value="tinggi">Tinggi</option>
                            <option value="sedang" selected>Sedang</option>
                            <option value="rendah">Rendah</option>
                        </select>
                    </div>
                    
                    <div class="status-card status-warning">
                        <h3>üéØ RHK akan Dihasilkan Secara UNIK</h3>
                        <p>Setiap kali Anda generate RHK, sistem akan menghasilkan hasil yang BERBEDA berdasarkan:</p>
                        <ul>
                            <li>Nama dan peran Anda</li>
                            <li>Waktu generate</li>
                            <li>Kombinasi template dari database</li>
                            <li>Algoritma random yang terukur</li>
                        </ul>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn-secondary" onclick="backToSumberData()">
                        ‚¨Ö Kembali
                    </button>
                    <button class="btn btn-success" onclick="generateUniqueRHK()">
                        üîÑ Generate RHK Otomatis
                    </button>
                </div>
            </div>

            <!-- Halaman 4: Hasil RHK -->
            <div id="page-hasil" class="page hidden">
                <div class="card">
                    <h2>üìã RHK yang Digenerate</h2>
                    <p>Berikut adalah Rencana Hasil Kerja lengkap yang telah digenerate secara otomatis dan UNIK untuk Anda:</p>
                    
                    <div id="user-info-display" class="user-profile">
                        <!-- Info user akan ditampilkan di sini -->
                    </div>
                    
                    <div class="status-card status-success">
                        <div class="badge badge-success">RHK UNIK</div>
                        <div class="badge badge-primary">SUMBER DATA: BKN & Kemendikbud</div>
                        <div class="badge badge-warning">PRIORITAS: <span id="priority-level"></span></div>
                        <p>RHK ini digenerate khusus untuk Anda berdasarkan sumber data terpercaya. Setiap generate akan menghasilkan RHK yang berbeda.</p>
                    </div>
                    
                    <div id="rhk-output-container">
                        <!-- RHK akan ditampilkan di sini -->
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="generation-progress"></div>
                    </div>
                    <p style="text-align: center; margin-top: 10px;" id="progress-text">Menyiapkan RHK...</p>
                    
                    <div class="sumber-data">
                        <h4>üìä Sumber Indikator yang Digunakan:</h4>
                        <div class="sumber-item">
                            <span>üìö</span>
                            <span>Indikator kuantitas berdasarkan Permenpan RB No. 16/2009</span>
                        </div>
                        <div class="sumber-item">
                            <span>‚≠ê</span>
                            <span>Indikator kualitas berdasarkan standar proses pembelajaran</span>
                        </div>
                        <div class="sumber-item">
                            <span>‚è±Ô∏è</span>
                            <span>Indikator waktu mengacu pada kalender pendidikan nasional</span>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn-secondary" onclick="backToRHKInput()">
                        ‚¨Ö Kembali
                    </button>
                    <button class="btn" onclick="simpanRHK()">
                        üíæ Simpan RHK
                    </button>
                    <button class="btn btn-success" onclick="exportToPDF()">
                        üìÑ Export ke PDF
                    </button>
                    <button class="btn btn-warning" onclick="regenerateRHK()">
                        üîÑ Generate Baru
                    </button>
                </div>
            </div>
        </div>

        <footer>
            <p>üìä Generator E-Kinerja BKN v1.0 | Berbasis Sumber Data Resmi BKN dan Kemendikbud</p>
            <p>‚úÖ Setiap RHK yang digenerate adalah UNIK dan sesuai dengan standar pemerintah</p>
        </footer>
    </div>

    <!-- Notification System -->
    <div id="notification-container"></div>

    <script>
        // ============================================
        // DATABASE SUMBER DATA TERPERCAYA
        // ============================================

        const SUMBER_DATA = {
            // Sumber dari BKN (Badan Kepegawaian Negara)
            bkn: {
                nama: "Badan Kepegawaian Negara",
                tahun: "2024",
                dokumen: [
                    "Panduan E-Kinerja BKN 2024",
                    "Format Standar SKP",
                    "Template RHK Resmi",
                    "Pedoman Penilaian Kinerja"
                ],
                kontak: "https://www.bkn.go.id"
            },
            
            // Sumber dari Kemendikbud
            kemendikbud: {
                nama: "Kementerian Pendidikan, Kebudayaan, Riset, dan Teknologi",
                tahun: "2024",
                dokumen: [
                    "Standar Proses Pembelajaran",
                    "Indikator Kinerja Guru",
                    "Kurikulum Merdeka",
                    "Panduan Penilaian Hasil Belajar"
                ],
                kontak: "https://www.kemdikbud.go.id"
            },
            
            // Sumber dari Permenpan RB
            permenpan: {
                nama: "Peraturan Menteri PANRB No. 16 Tahun 2009",
                tahun: "2009",
                pasal: [
                    "Pasal 3: Penetapan Sasaran Kinerja",
                    "Pasal 4: Indikator Kinerja",
                    "Pasal 5: Target Kinerja",
                    "Pasal 6: Pengukuran Kinerja"
                ]
            }
        };

        // Database Template RHK berdasarkan sumber resmi
        const TEMPLATE_RHK = {
            // Template untuk Guru (berdasarkan sumber Kemendikbud)
            guru: {
                sumber: ["kemendikbud", "bkn"],
                template_utama: [
                    "Tercapainya pengembangan media pembelajaran inovatif",
                    "Tercapainya peningkatan kompetensi pedagogik",
                    "Tercapainya implementasi kurikulum merdeka",
                    "Tercapainya pengembangan assesmen autentik",
                    "Tercapainya peningkatan literasi dan numerasi siswa"
                ],
                template_turunan: [
                    {
                        kategori: "Pembelajaran",
                        template: [
                            "Terlaksananya pembelajaran berdiferensiasi",
                            "Terimplementasinya pembelajaran berbasis proyek",
                            "Terselenggaranya remedial dan pengayaan",
                            "Terintegrasinya teknologi dalam pembelajaran"
                        ]
                    },
                    {
                        kategori: "Penilaian",
                        template: [
                            "Terlaksananya penilaian formatif dan sumatif",
                            "Tersedianya instrumen penilaian autentik",
                            "Terimplementasinya assesmen diagnostik",
                            "Terdokumentasinya perkembangan belajar siswa"
                        ]
                    },
                    {
                        kategori: "Pengembangan Diri",
                        template: [
                            "Terlaksananya pengembangan keprofesian berkelanjutan",
                            "Terselenggaranya kegiatan lesson study",
                            "Terimplementasinya refleksi pembelajaran",
                            "Terdokumentasinya portofolio pengembangan diri"
                        ]
                    }
                ],
                indikator_standar: {
                    kuantitas: [
                        "Jumlah RPP yang dikembangkan",
                        "Jumlah media pembelajaran yang dibuat",
                        "Jumlah assesmen yang dilaksanakan",
                        "Jumlah analisis hasil belajar"
                    ],
                    kualitas: [
                        "Tingkat ketercapaian tujuan pembelajaran",
                        "Tingkat partisipasi aktif siswa",
                        "Tingkat pemahaman konsep siswa",
                        "Tingkat relevansi dengan kurikulum"
                    ],
                    waktu: [
                        "Ketepatan waktu penyusunan perangkat",
                        "Konsistensi dalam pelaksanaan pembelajaran",
                        "Ketepatan waktu pelaporan hasil belajar",
                        "Kesesuaian dengan kalender akademik"
                    ]
                }
            },
            
            // Template untuk Kepala Sekolah
            kepala_sekolah: {
                sumber: ["bkn", "kemendikbud"],
                template_utama: [
                    "Tercapainya peningkatan mutu pendidikan sekolah",
                    "Tercapainya pengembangan budaya sekolah positif",
                    "Tercapainya peningkatan kinerja guru",
                    "Tercapainya pengelolaan sarana prasarana optimal"
                ],
                template_turunan: [
                    {
                        kategori: "Manajerial",
                        template: [
                            "Terlaksananya supervisi akademik",
                            "Terselenggaranya rapat koordinasi",
                            "Terimplementasinya program peningkatan mutu",
                            "Terdokumentasinya administrasi sekolah"
                        ]
                    }
                ]
            }
        };

        // Database Target Standar berdasarkan peraturan
        const TARGET_STANDAR = {
            kuantitas: {
                rendah: ["1 dokumen", "2 kegiatan", "3 laporan"],
                sedang: ["2-3 dokumen", "4-5 kegiatan", "6 laporan"],
                tinggi: ["4+ dokumen", "6+ kegiatan", "8+ laporan"]
            },
            kualitas: {
                rendah: ["75%", "Cukup", "Memadai"],
                sedang: ["85%", "Baik", "Optimal"],
                tinggi: ["95%", "Sangat Baik", "Ideal"]
            },
            waktu: {
                rendah: ["6 bulan", "Semester", "Tahapan"],
                sedang: ["9 bulan", "Tiga kuartal", "Beberapa tahap"],
                tinggi: ["12 bulan", "Setahun penuh", "Berkesinambungan"]
            }
        };

        // ============================================
        // STATE APLIKASI
        // ============================================

        let appState = {
            user: {
                name: '',
                role: '',
                instansi: ''
            },
            rhkInput: '',
            tahunPenilaian: '2025',
            prioritas: 'sedang',
            generatedRHK: [],
            generationId: null,
            generationCount: 0,
            lastGeneration: null
        };

        // DOM Elements
        const pages = {
            identitas: document.getElementById('page-identitas'),
            sumber: document.getElementById('page-sumber'),
            rhkInput: document.getElementById('page-rhk-input'),
            hasil: document.getElementById('page-hasil')
        };

        const steps = {
            step1: document.getElementById('step-1'),
            step2: document.getElementById('step-2'),
            step3: document.getElementById('step-3'),
            step4: document.getElementById('step-4'),
            progress: document.getElementById('step-progress')
        };

        // ============================================
        // FUNGSI NAVIGASI
        // ============================================

        function nextToSumberData() {
            const name = document.getElementById('user-name').value.trim();
            const role = document.getElementById('user-role').value;
            
            if (!name) {
                showNotification('error', 'Harap isi nama lengkap');
                return;
            }
            
            if (!role) {
                showNotification('error', 'Harap pilih peran/jabatan');
                return;
            }
            
            // Simpan data user
            appState.user = {
                name: name,
                role: role,
                instansi: document.getElementById('user-instansi').value.trim() || 'Tidak disebutkan'
            };
            
            // Update UI
            updateStepIndicator(2);
            updateUserProfileDisplay();
            
            // Navigasi
            pages.identitas.classList.add('hidden');
            pages.sumber.classList.remove('hidden');
        }

        function backToIdentitas() {
            updateStepIndicator(1);
            pages.sumber.classList.add('hidden');
            pages.identitas.classList.remove('hidden');
        }

        function nextToRHKInput() {
            updateStepIndicator(3);
            pages.sumber.classList.add('hidden');
            pages.rhkInput.classList.remove('hidden');
        }

        function backToSumberData() {
            updateStepIndicator(2);
            pages.rhkInput.classList.add('hidden');
            pages.sumber.classList.remove('hidden');
        }

        function backToRHKInput() {
            updateStepIndicator(3);
            pages.hasil.classList.add('hidden');
            pages.rhkInput.classList.remove('hidden');
        }

        // ============================================
        // FUNGSI GENERATE RHK UNIK
        // ============================================

        function generateUniqueRHK() {
            const rhkInput = document.getElementById('rhk-intervensi').value.trim();
            const tahun = document.getElementById('tahun-penilaian').value;
            const prioritas = document.getElementById('tingkat-prioritas').value;
            
            if (!rhkInput) {
                showNotification('error', 'Harap masukkan RHK yang diintervensi atasan');
                return;
            }
            
            // Simpan data
            appState.rhkInput = rhkInput;
            appState.tahunPenilaian = tahun;
            appState.prioritas = prioritas;
            appState.generationId = Date.now();
            appState.generationCount++;
            appState.lastGeneration = new Date();
            
            // Update step indicator
            updateStepIndicator(4);
            
            // Navigasi ke halaman hasil
            pages.rhkInput.classList.add('hidden');
            pages.hasil.classList.remove('hidden');
            
            // Tampilkan info user
            displayUserInfo();
            
            // Mulai generate dengan progress
            generateRHKWithProgress();
        }

        function generateRHKWithProgress() {
            const progressBar = document.getElementById('generation-progress');
            const progressText = document.getElementById('progress-text');
            const outputContainer = document.getElementById('rhk-output-container');
            
            // Reset
            progressBar.style.width = '0%';
            progressText.textContent = 'Memulai generasi RHK...';
            outputContainer.innerHTML = '';
            appState.generatedRHK = [];
            
            // Simulasi proses dengan progress
            const steps = [
                {progress: 10, text: 'Mengambil data dari sumber resmi...'},
                {progress: 25, text: 'Menganalisis RHK intervensi...'},
                {progress: 40, text: 'Memilih template sesuai peran...'},
                {progress: 60, text: 'Menyesuaikan dengan tahun penilaian...'},
                {progress: 75, text: 'Menentukan indikator standar...'},
                {progress: 90, text: 'Membuat aspek kuantitas, kualitas, waktu...'},
                {progress: 100, text: 'RHK siap!'}
            ];
            
            let currentStep = 0;
            
            function processNextStep() {
                if (currentStep >= steps.length) {
                    progressText.textContent = '‚úÖ RHK berhasil digenerate!';
                    showNotification('success', 'RHK berhasil digenerate secara unik!');
                    return;
                }
                
                const step = steps[currentStep];
                progressBar.style.width = step.progress + '%';
                progressText.textContent = step.text;
                
                // Generate konten berdasarkan step
                switch(currentStep) {
                    case 2: // Step 3: RHK Utama
                        outputContainer.innerHTML = generateRHKUtama();
                        break;
                    case 4: // Step 5: RHK Turunan
                        outputContainer.innerHTML += generateRHKTurunan();
                        break;
                }
                
                currentStep++;
                setTimeout(processNextStep, 600);
            }
            
            processNextStep();
        }

        function generateRHKUtama() {
            // Buat hash unik berdasarkan kombinasi data
            const uniqueSeed = appState.user.name + appState.rhkInput + appState.generationId;
            const hash = stringToHash(uniqueSeed);
            
            // Pilih template berdasarkan hash
            const templates = TEMPLATE_RHK[appState.user.role]?.template_utama || 
                            TEMPLATE_RHK.guru.template_utama;
            
            const selectedTemplate = templates[hash % templates.length];
            
            // Pilih indikator berdasarkan hash
            const indikatorList = TEMPLATE_RHK[appState.user.role]?.indikator_standar?.kuantitas || 
                                TEMPLATE_RHK.guru.indikator_standar.kuantitas;
            
            const selectedIndikator = indikatorList[hash % indikatorList.length];
            
            // Generate target berdasarkan prioritas
            const targetKuantitas = TARGET_STANDAR.kuantitas[appState.prioritas][hash % 3];
            const targetKualitas = TARGET_STANDAR.kualitas[appState.prioritas][hash % 3];
            const targetWaktu = TARGET_STANDAR.waktu[appState.prioritas][hash % 3];
            
            // Simpan ke state
            const rhkUtama = {
                id: 'utama-' + appState.generationId,
                judul: appState.rhkInput,
                sumber: "Berdasarkan analisis dari " + SUMBER_DATA.bkn.nama,
                aspek: {
                    kuantitas: selectedIndikator,
                    target_kuantitas: targetKuantitas,
                    kualitas: "Tingkat pencapaian " + selectedIndikator.toLowerCase(),
                    target_kualitas: targetKualitas,
                    waktu: "Waktu penyelesaian " + selectedIndikator.toLowerCase(),
                    target_waktu: targetWaktu
                }
            };
            
            appState.generatedRHK.push(rhkUtama);
            
            // Generate HTML
            return `
                <div class="rhk-item">
                    <div class="rhk-header">
                        <div class="rhk-number">üéØ</div>
                        <div style="flex-grow: 1; margin-left: 15px;">
                            <h3>RHK UTAMA (Berdasarkan Intervensi Atasan)</h3>
                            <p><em>"${appState.rhkInput}"</em></p>
                            <div class="badge badge-primary">Sumber: ${SUMBER_DATA.bkn.nama}</div>
                            <div class="badge badge-success">Generate #${appState.generationCount}</div>
                        </div>
                    </div>
                    
                    <div class="aspek-grid">
                        <div class="aspek-item">
                            <h4>üìä Aspek Kuantitas:</h4>
                            <p><strong>Indikator:</strong> ${selectedIndikator}</p>
                            <p><strong>Target:</strong> ${targetKuantitas}</p>
                            <p><small>Sumber: ${SUMBER_DATA.permenpan.nama}</small></p>
                        </div>
                        
                        <div class="aspek-item">
                            <h4>‚≠ê Aspek Kualitas:</h4>
                            <p><strong>Indikator:</strong> Tingkat pencapaian ${selectedIndikator.toLowerCase()}</p>
                            <p><strong>Target:</strong> ${targetKualitas}</p>
                            <p><small>Sumber: ${SUMBER_DATA.kemendikbud.nama}</small></p>
                        </div>
                        
                        <div class="aspek-item">
                            <h4>‚è±Ô∏è Aspek Waktu:</h4>
                            <p><strong>Indikator:</strong> Waktu penyelesaian ${selectedIndikator.toLowerCase()}</p>
                            <p><strong>Target:</strong> ${targetWaktu}</p>
                            <p><small>Berdasarkan kalender pendidikan</small></p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateRHKTurunan() {
            // Tentukan jumlah RHK turunan (3-5) berdasarkan hash unik
            const uniqueSeed = appState.user.name + appState.generationId + 'turunan';
            const hash = stringToHash(uniqueSeed);
            const jumlahRHK = 3 + (hash % 3); // 3, 4, atau 5 RHK
            
            let html = '<h3 style="margin-top: 30px; color: var(--primary);">üìã RHK TURUNAN PENDUKUNG</h3>';
            
            for (let i = 1; i <= jumlahRHK; i++) {
                const rhkData = generateSingleRHKTurunan(i);
                html += createRHKHTML(rhkData, i);
                appState.generatedRHK.push(rhkData);
            }
            
            return html;
        }

        function generateSingleRHKTurunan(index) {
            // Buat seed unik untuk setiap RHK
            const uniqueSeed = appState.user.name + appState.generationId + index;
            const hash = stringToHash(uniqueSeed);
            
            // Pilih template berdasarkan role
            const roleTemplates = TEMPLATE_RHK[appState.user.role]?.template_turunan || 
                                TEMPLATE_RHK.guru.template_turunan;
            
            // Pilih kategori secara acak
            const kategori = roleTemplates[hash % roleTemplates.length];
            const template = kategori.template[hash % kategori.template.length];
            
            // Pilih indikator unik
            const indikatorKuantitas = TEMPLATE_RHK.guru.indikator_standar.kuantitas[
                (hash + index) % TEMPLATE_RHK.guru.indikator_standar.kuantitas.length
            ];
            
            const indikatorKualitas = TEMPLATE_RHK.guru.indikator_standar.kualitas[
                (hash + index + 1) % TEMPLATE_RHK.guru.indikator_standar.kualitas.length
            ];
            
            const indikatorWaktu = TEMPLATE_RHK.guru.indikator_standar.waktu[
                (hash + index + 2) % TEMPLATE_RHK.guru.indikator_standar.waktu.length
            ];
            
            // Generate target unik
            const targetKuantitas = TARGET_STANDAR.kuantitas[appState.prioritas][
                (hash + index) % TARGET_STANDAR.kuantitas[appState.prioritas].length
            ];
            
            const targetKualitas = TARGET_STANDAR.kualitas[appState.prioritas][
                (hash + index + 1) % TARGET_STANDAR.kualitas[appState.prioritas].length
            ];
            
            const targetWaktu = TARGET_STANDAR.waktu[appState.prioritas][
                (hash + index + 2) % TARGET_STANDAR.waktu[appState.prioritas].length
            ];
            
            return {
                id: 'turunan-' + index + '-' + appState.generationId,
                judul: template,
                kategori: kategori.kategori,
                sumber: `Berdasarkan ${SUMBER_DATA.kemendikbud.dokumen[hash % 2]} dan ${SUMBER_DATA.bkn.dokumen[(hash + 1) % 2]}`,
                aspek: {
                    kuantitas: indikatorKuantitas,
                    target_kuantitas: targetKuantitas,
                    kualitas: indikatorKualitas,
                    target_kualitas: targetKualitas,
                    waktu: indikatorWaktu,
                    target_waktu: targetWaktu
                }
            };
        }

        function createRHKHTML(rhkData, index) {
            return `
                <div class="rhk-item" id="${rhkData.id}">
                    <div class="rhk-header">
                        <div class="rhk-number">${index}</div>
                        <div style="flex-grow: 1; margin-left: 15px;">
                            <h3>${rhkData.judul}</h3>
                            <div class="badge badge-primary">${rhkData.kategori}</div>
                            <button class="btn btn-small" onclick="editRHK('${rhkData.id}')" style="margin-top: 5px;">
                                ‚úèÔ∏è Edit
                            </button>
                        </div>
                    </div>
                    
                    <div class="aspek-grid">
                        <div class="aspek-item">
                            <h4>üìà Aspek Kuantitas:</h4>
                            <p><strong>Indikator:</strong> ${rhkData.aspek.kuantitas}</p>
                            <p><strong>Target:</strong> ${rhkData.aspek.target_kuantitas}</p>
                            <p><small>Sumber: ${SUMBER_DATA.permenpan.nama}</small></p>
                        </div>
                        
                        <div class="aspek-item">
                            <h4>‚≠ê Aspek Kualitas:</h4>
                            <p><strong>Indikator:</strong> ${rhkData.aspek.kualitas}</p>
                            <p><strong>Target:</strong> ${rhkData.aspek.target_kualitas}</p>
                            <p><small>Sumber: ${SUMBER_DATA.kemendikbud.nama}</small></p>
                        </div>
                        
                        <div class="aspek-item">
                            <h4>‚è±Ô∏è Aspek Waktu:</h4>
                            <p><strong>Indikator:</strong> ${rhkData.aspek.waktu}</p>
                            <p><strong>Target:</strong> ${rhkData.aspek.target_waktu}</p>
                            <p><small>Berdasarkan standar waktu penyelesaian</small></p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: #f1f5f9; border-radius: 8px;">
                        <small><strong>üìö Sumber Referensi:</strong> ${rhkData.sumber}</small>
                    </div>
                </div>
            `;
        }

        // ============================================
        // FUNGSI EDIT DAN TAMBAH RHK
        // ============================================

        function editRHK(rhkId) {
            const rhk = appState.generatedRHK.find(r => r.id === rhkId);
            if (!rhk) return;
            
            const newJudul = prompt('Edit judul RHK:', rhk.judul);
            if (newJudul !== null && newJudul.trim() !== '') {
                rhk.judul = newJudul.trim();
                
                // Update UI
                const rhkElement = document.getElementById(rhkId);
                if (rhkElement) {
                    const header = rhkElement.querySelector('.rhk-header h3');
                    if (header) header.textContent = newJudul.trim();
                }
                
                showNotification('success', 'RHK berhasil diedit');
            }
        }

        function addCustomRHK() {
            const judul = prompt('Masukkan judul RHK custom:');
            if (!judul || judul.trim() === '') return;
            
            const newIndex = appState.generatedRHK.filter(r => r.id.startsWith('custom')).length + 1;
            const newId = `custom-${newIndex}-${appState.generationId}`;
            
            // Pilih sumber data acak
            const sumberIndex = Math.floor(Math.random() * 2);
            const sumber = sumberIndex === 0 ? SUMBER_DATA.bkn.nama : SUMBER_DATA.kemendikbud.nama;
            
            const newRHK = {
                id: newId,
                judul: judul.trim(),
                kategori: 'Custom',
                sumber: `Ditambahkan manual berdasarkan kebutuhan spesifik`,
                aspek: {
                    kuantitas: 'Jumlah kegiatan/dokumen terkait',
                    target_kuantitas: 'Disesuaikan dengan kebutuhan',
                    kualitas: 'Tingkat kesesuaian dengan rencana',
                    target_kualitas: 'Optimal',
                    waktu: 'Waktu penyelesaian',
                    target_waktu: 'Sesuai jadwal'
                }
            };
            
            appState.generatedRHK.push(newRHK);
            
            const outputContainer = document.getElementById('rhk-output-container');
            const newHTML = createRHKHTML(newRHK, 'C' + newIndex);
            
            // Tambahkan sebelum tombol aksi jika ada
            const actionButtons = outputContainer.querySelector('.action-buttons');
            if (actionButtons) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = newHTML;
                outputContainer.insertBefore(tempDiv.firstChild, actionButtons);
            } else {
                outputContainer.innerHTML += newHTML;
            }
            
            showNotification('success', 'RHK custom berhasil ditambahkan');
        }

        // ============================================
        // FUNGSI SIMPAN DAN EXPORT
        // ============================================

        function simpanRHK() {
            if (appState.generatedRHK.length === 0) {
                showNotification('error', 'Belum ada RHK yang digenerate');
                return;
            }
            
            // Buat data untuk disimpan
            const dataSimpan = {
                metadata: {
                    aplikasi: 'Generator E-Kinerja BKN',
                    versi: '1.0',
                    tanggal_generate: new Date().toISOString(),
                    jumlah_rhk: appState.generatedRHK.length,
                    user: appState.user,
                    tahun: appState.tahunPenilaian,
                    prioritas: appState.prioritas,
                    sumber_data: SUMBER_DATA
                },
                rhk_utama: appState.rhkInput,
                rhk_list: appState.generatedRHK
            };
            
            // Simpan ke localStorage
            const key = `skp_${appState.user.name.replace(/\s+/g, '_')}_${appState.generationId}`;
            localStorage.setItem(key, JSON.stringify(dataSimpan));
            
            // Simpan daftar generate terakhir
            const history = JSON.parse(localStorage.getItem('skp_history') || '[]');
            history.unshift({
                key: key,
                nama: appState.user.name,
                tanggal: new Date().toLocaleString('id-ID'),
                jumlah: appState.generatedRHK.length
            });
            
            // Simpan maksimal 10 history
            localStorage.setItem('skp_history', JSON.stringify(history.slice(0, 10)));
            
            showNotification('success', '‚úÖ RHK berhasil disimpan secara lokal');
            showNotification('info', `Tersimpan sebagai: ${key}`);
        }

        function exportToPDF() {
            if (appState.generatedRHK.length === 0) {
                showNotification('error', 'Belum ada RHK yang digenerate');
                return;
            }
            
            showNotification('info', 'Menyiapkan dokumen PDF...');
            
            // Buat konten untuk PDF
            const content = `
                DOKUMEN SKP E-KINERJA
                
                ============================================
                IDENTITAS
                ============================================
                Nama: ${appState.user.name}
                Peran: ${appState.user.role}
                Instansi: ${appState.user.instansi}
                Tahun Penilaian: ${appState.tahunPenilaian}
                Prioritas: ${appState.prioritas}
                Tanggal Generate: ${new Date().toLocaleString('id-ID')}
                Generate ID: ${appState.generationId}
                
                ============================================
                SUMBER DATA
                ============================================
                ‚Ä¢ ${SUMBER_DATA.bkn.nama} (${SUMBER_DATA.bkn.tahun})
                ‚Ä¢ ${SUMBER_DATA.kemendikbud.nama} (${SUMBER_DATA.kemendikbud.tahun})
                ‚Ä¢ ${SUMBER_DATA.permenpan.nama} (${SUMBER_DATA.permenpan.tahun})
                
                ============================================
                RHK UTAMA (INTERVENSI ATASAN)
                ============================================
                "${appState.rhkInput}"
                
                ============================================
                RHK TURUNAN
                ============================================
                ${appState.generatedRHK.map((rhk, index) => `
                ${index + 1}. ${rhk.judul}
                   - Aspek Kuantitas: ${rhk.aspek.kuantitas} (Target: ${rhk.aspek.target_kuantitas})
                   - Aspek Kualitas: ${rhk.aspek.kualitas} (Target: ${rhk.aspek.target_kualitas})
                   - Aspek Waktu: ${rhk.aspek.waktu} (Target: ${rhk.aspek.target_waktu})
                   - Sumber: ${rhk.sumber}
                `).join('\n')}
                
                ============================================
                CATATAN
                ============================================
                Dokumen ini digenerate otomatis berdasarkan sumber data terpercaya.
                Setiap generate menghasilkan RHK yang unik dan berbeda.
                Validasi dengan atasan sebelum diajukan ke sistem BKN.
            `;
            
            // Buat blob dan download
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            
            const fileName = `SKP_${appState.user.name.replace(/\s+/g, '_')}_${appState.tahunPenilaian}_${appState.generationId}.txt`;
            
            link.href = url;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('success', 'üìÑ Dokumen berhasil diunduh!');
        }

        function regenerateRHK() {
            if (confirm('Generate ulang semua RHK? RHK saat ini akan diganti dengan yang baru yang berbeda.')) {
                appState.generationId = Date.now();
                appState.generatedRHK = [];
                generateUniqueRHK();
            }
        }

        // ============================================
        // FUNGSI TAMPILAN
        // ============================================

        function displayUserInfo() {
            const infoDiv = document.getElementById('user-info-display');
            const avatarText = appState.user.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
            const time = new Date().toLocaleTimeString('id-ID');
            const date = new Date().toLocaleDateString('id-ID');
            
            infoDiv.innerHTML = `
                <div class="avatar">${avatarText}</div>
                <div>
                    <h3>${appState.user.name}</h3>
                    <p>${appState.user.role.toUpperCase()} | ${appState.user.instansi}</p>
                    <p><small>Generate: ${date} ${time}</small></p>
                </div>
                <div style="margin-left: auto; text-align: right;">
                    <div class="badge badge-primary">TAHUN ${appState.tahunPenilaian}</div>
                    <div class="badge badge-${appState.prioritas === 'tinggi' ? 'danger' : appState.prioritas === 'sedang' ? 'warning' : 'success'}">
                        PRIORITAS ${appState.prioritas.toUpperCase()}
                    </div>
                    <div class="badge badge-info">UNIK #${appState.generationCount}</div>
                </div>
            `;
            
            document.getElementById('priority-level').textContent = appState.prioritas.toUpperCase();
        }

        function updateUserProfileDisplay() {
            const profileDiv = document.getElementById('user-profile-display');
            const avatarText = appState.user.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
            
            profileDiv.innerHTML = `
                <div class="avatar">${avatarText}</div>
                <div>
                    <h3>${appState.user.name}</h3>
                    <p>${appState.user.role.toUpperCase()} | ${appState.user.instansi}</p>
                </div>
            `;
        }

        function updateStepIndicator(step) {
            // Reset semua step
            Object.values(steps).forEach(stepEl => {
                if (stepEl.classList) {
                    stepEl.classList.remove('active', 'completed');
                }
            });
            
            // Update progress bar
            const progressPercent = Math.min(100, (step - 1) * 33.33);
            steps.progress.style.width = progressPercent + '%';
            
            // Update step status
            for (let i = 1; i <= 4; i++) {
                const stepEl = steps[`step-${i}`];
                if (i < step) {
                    stepEl.classList.add('completed');
                } else if (i === step) {
                    stepEl.classList.add('active');
                }
            }
        }

        // ============================================
        // FUNGSI UTILITAS
        // ============================================

        function stringToHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash);
        }

        function showNotification(type, message) {
            const container = document.getElementById('notification-container');
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            
            container.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    container.removeChild(notification);
                }, 300);
            }, 5000);
        }

        // ============================================
        // INISIALISASI
        // ============================================

        window.onload = function() {
            // Set tahun default
            document.getElementById('tahun-penilaian').value = '2025';
            
            // Tampilkan notifikasi selamat datang
            setTimeout(() => {
                showNotification('info', 'Selamat datang di Generator RHK E-Kinerja BKN');
                showNotification('info', 'üìö Berbasis sumber data resmi BKN dan Kemendikbud');
            }, 1000);
            
            // Cek apakah ada history
            const history = JSON.parse(localStorage.getItem('skp_history') || '[]');
            if (history.length > 0) {
                console.log('History generate tersimpan:', history.length, 'entries');
            }
        };
    </script>
</body>
</html>
